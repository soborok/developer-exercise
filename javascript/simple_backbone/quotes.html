<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
                    "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
  <script src="http://code.jquery.com/jquery-latest.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/backbone.js/1.1.2/backbone-min.js"></script>
  <script src="./backbone.paginator.js"></script>
  <script src="./quotes.js"></script>
  <link rel="stylesheet" type="text/css" href="quote.css">
</head>

<body>
  <header id="list-title">
    <h2>Quote List</h2>
    <span class="quote filter movies" id="movies">movies
    </span>
    <span class="quote filter games" id="games">games
    </span>
  </header>
  <div id="quote-list">
  </div>
</body>

<script>
  var quotes = new QuoteCollection();
  var quoteListView = new QuoteListView({ collection: quotes });
  
  quotes.fetch({ reset: true });
  $("#quote-list").append(quoteListView.el);

  $("#list-title span").on('click', function() {
    var theme = $(this).attr('id');

    var quotesOfTheme = new Backbone.Collection(quotes.filter(function(quote) {
      return quote.get("theme") == theme;
    }));

    replaceQuoteList(quotesOfTheme);
  });

  $("#list-title h2").on('click', function() {
    replaceQuoteList(quotes);
  });


  function replaceQuoteList(newQuotes) {
    quoteListView = new QuoteListView({ collection: newQuotes });    
    quoteListView.addAll();
    $("#quote-list ul").replaceWith(quoteListView.el);
  }
  </script>
</html>
